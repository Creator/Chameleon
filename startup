if not shell then error() end
local function readfile(file)
  local x = fs.open(file, 'r')
  if not x then
    error("Can not open file "..file,2)
  end
  local ret = x.readAll()
  x.close()
  return ret
end

if fs.exists('/.bootrc') then
  local kernel = readfile('/.bootrc')
  print(fs.combine(kernel, '/main.lua'))
  loadfile(fs.combine(kernel, '/main.lua'))(kernel)
else
  loadfile('/kernelnext/main.lua')('/kernelnext')
end
