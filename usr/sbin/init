logf("[Chameleon] Loading.")

if not fs.exists('/usr/etc/sysw.conf') then
  logf('[critical] System Worker configuration not found, exiting.')
end

local x = fs.open('/usr/etc/sysw.conf', 'r')
local data = textutils.unserialize(x.readAll())
x.close()

local sysw = Task()

for k, v in ipairs(data) do
  sysw:newThread(loadfile(v))
end

sysw:resume()
sysw:update("sysw_start")
sysw:stop()
error()
